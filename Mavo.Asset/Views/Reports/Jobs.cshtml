@using Mavo.Assets;
@model Mavo.Assets.Models.ViewModel.JobReportViewModel
@section scripts
{
    <script type="text/javascript">
        setTimeout(60 * 1000 * 5, function () { window.location.reload(true); });
    </script>
}

<div class="row-fluid">
    <div class="span6 well">
        <h4>Ready to pick today</h4>
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>Job</th>
                    <th>Job Number</th>
                    <th>Pick Time</th>
                    <th>Project Manager</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var job in Model.ReadyToPick)
                {
                    <tr>
                        <td><a href="/job/edit/@job.Id">@job.Name</a></td>
                        <td>@job.JobNumber</td>
                        <td>
                            <span class='label @(job.Status == Mavo.Assets.Models.JobStatus.BeingPicked ? "label-success" : job.PickupTime < DateTime.Now ? "label-important" : job.PickupTime > DateTime.Now && job.PickupTime <= DateTime.Now.AddHours(1) ? "label-warning" : "")'>@job.PickupTime.ToShortTimeString()</span>
                        </td>
                        <td>@(job.ProjectManager != null ? job.ProjectManager.FullName : "")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <div class="span6 well">
        <h4>Ready to return today</h4>
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>Job</th>
                    <th>Job Number</th>
                    <th>Estimated Completion Time</th>
                    <th>Project Manager</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var job in Model.ReadyToReturn)
                {
                    <tr>
                        <td><a href="/job/edit/@job.Id">@job.Name</a></td>
                        <td>@job.JobNumber</td>
                        <td>
                            @job.EstimatedCompletionDate
                        </td>
                        <td>@(job.ProjectManager != null ? job.ProjectManager.FullName : "")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="row-fluid">
    <div class="span6 well">
        <h4>Jobs being picked right now</h4>
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>Job</th>
                    <th>Job Number</th>
                    <th>Pick Time</th>
                    <th>Pick Started</th>
                    <th>Picked By</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var job in Model.BeingPicked)
                {
                    <tr>
                        <td><a href="/job/edit/@job.Id">@job.Name</a></td>
                        <td>@job.JobNumber</td>
                        <td>
                            <span class='label @(job.Status == Mavo.Assets.Models.JobStatus.BeingPicked ? "label-success" : job.PickupTime < DateTime.Now ? "label-important" : job.PickupTime > DateTime.Now && job.PickupTime <= DateTime.Now.AddHours(1) ? "label-warning" : "")'>@job.PickupTime.ToShortTimeString()</span>
                        </td>
                        <td>@job.PickStarted.Value.ToShortTimeString()</td>
                        <td>@(job.PickedBy != null ? job.PickedBy.FullName : "so and so")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <div class="span6 well">
        <h4>Jobs being returned right now</h4>
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>Job</th>
                    <th>Job Number</th>
                    <th>Return Started</th>
                    <th>Returned By</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var job in Model.BeingReturned)
                {
                    <tr>
                        <td><a href="/job/edit/@job.Id">@job.Name</a></td>
                        <td>@job.JobNumber</td>
                        <td>
                            @job.ReturnStarted.Value.ToShortTimeString()
                        </td>
                        <td>@(job.ReturnedBy != null ? job.ReturnedBy.FullName : "so and so")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="row-fluid">
    <div class="span6 well">
        <h4>Jobs we already picked today</h4>
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>Job</th>
                    <th>Job Number</th>
                    <th>Pick Started</th>
                    <th>Pick Ended</th>
                    <th>Elapsed</th>
                    <th>Picked By</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var job in Model.AlreadyPicked)
                {
                    <tr>
                        <td><a href="/job/edit/@job.Id">@job.Name</a></td>
                        <td>@job.JobNumber</td>
                        <td>@job.PickStarted.Value.ToShortTimeString()</td>
                        <td>@job.PickCompleted.Value.ToShortTimeString()</td>
                        <td>@((job.PickCompleted.Value - job.PickStarted.Value).ToRelative())</td>
                        <td>@(job.PickedBy != null ? job.PickedBy.FullName : "so and so")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <div class="span6 well">
        <h4>Jobs we already returned today</h4>
        <table class="table table-striped table-hover table-condensed">
            <thead>
                <tr>
                    <th>Job</th>
                    <th>Job Number</th>
                    <th>Return Started</th>
                    <th>Return Completed</th>
                    <th>Elapsed</th>
                    <th>Picked By</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var job in Model.AlreadyReturned)
                {
                    <tr>
                        <td><a href="/job/edit/@job.Id">@job.Name</a></td>
                        <td>@job.JobNumber</td>
                        <td>
                            @job.ReturnStarted.Value.ToShortTimeString()
                        </td>
                        <td>@job.ReturnCompleted.Value.ToShortTimeString()</td>
                        <td>@((job.ReturnCompleted.Value - job.ReturnStarted.Value).ToRelative())</td>
                        <td>@(job.ReturnedBy != null ? job.ReturnedBy.FullName : "so and so")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>

<div class="alert alert-info">
    Data generated on <strong>@DateTime.Now.ToShortDateString()</strong> on <strong>@DateTime.Now.ToShortTimeString()</strong>
</div>