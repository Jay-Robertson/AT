@using Mavo.Assets.Models
@model Mavo.Assets.Models.Template
@section LeftNav
{
    @{
        Html.RenderPartial("_TemplateSidebar", new Mavo.Assets.Models.ViewModel.TemplatesLeftNavViewModel() { Template = Model, Templates = ViewBag.Templates });
    }
}
@{ 
    var currentUserRole = (UserRole)ViewBag.CurrentUserRole;
    var canEdit = !Model.Master || currentUserRole == UserRole.Administrator;
}

@using (Html.BeginForm(MVC.Template.Edit(Model == null ? 0 : Model.Id), FormMethod.Post, new { @class = "form-horizontal" }))
{
    <div class="row-fluid">
        <div class="well">
            <h4>Template Details</h4>
            <div class="control-group">
                @Html.LabelTitleizeFor(x => x.Name)
                <div class="controls">
                    @Html.TextBoxFor(x => x.Name)
                </div>
            </div>
            <div class="control-group">
                @Html.LabelTitleizeFor(x => x.Master)
                <div class="controls">
                    @Html.CheckBoxFor(x => x.Master)
                </div>
            </div>
        </div>

    </div>
    <div class="row-fluid">
        <div class="form-actions">
            <input type="submit" class="btn btn-primary" @(canEdit ? "" : "disabled=\"disabled\"") />
        </div>
    </div>
}
@if (Model != null)
{
    <div class="row-fluid">
        <div class="well">
            <h4>Template Assets</h4>
            @{Html.RenderAction("AssetPickerForTemplate", "Asset");}
        </div>
    </div>
}

@if (!canEdit) 
{
    <script type="text/javascript">
        jQuery(function ($) {
            $('input, button, a.btn.btn-danger').attr('disabled', 'disabled');
        });
    </script>
}
